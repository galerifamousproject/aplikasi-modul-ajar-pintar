<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administrasi Guru Pintar - Galeri Famous Project</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        :root { --primary: #4338ca; --secondary: #db2777; --bg: #e2e8f0; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: #1e293b; line-height: 1.5; }

        header {
            background: linear-gradient(-45deg, #4338ca, #6366f1, #db2777, #ec4899);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            padding: 3rem 2rem 6rem; text-align: center; color: white;
            border-bottom: 4px solid rgba(255, 255, 255, 0.1);
        }
        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        .main-container {
            max-width: 1600px; margin: -4rem auto 4rem; padding: 0 2rem;
            display: flex; justify-content: center; align-items: flex-start; gap: 2.5rem;
        }

        @media (max-width: 1250px) {
            .main-container { flex-direction: column; align-items: center; margin-top: -2rem; }
            .sidebar { width: 100% !important; max-width: 600px; position: static !important; }
        }

        .sidebar {
            width: 420px; background: white; border-radius: 2rem; padding: 2.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1); position: sticky; top: 2rem; flex-shrink: 0;
        }

        .preview-section { flex-grow: 1; display: flex; flex-direction: column; align-items: center; width: 100%; }

        .paper-shadow {
            background: white; width: 210mm; min-height: 297mm; padding: 25mm;
            box-shadow: 0 0 50px rgba(0,0,0,0.15); font-family: 'Times New Roman', serif;
            color: #000; outline: none; border-radius: 2px; text-align: justify;
        }

        .form-label { display: block; font-size: 0.75rem; font-weight: 800; color: #64748b; margin-bottom: 0.5rem; text-transform: uppercase; }
        .input-control { width: 100%; padding: 0.9rem; border-radius: 1rem; border: 2px solid #f1f5f9; background: #fcfcfc; margin-bottom: 1.2rem; outline: none; font-size: 0.9rem; transition: 0.3s; }
        .input-control:focus { border-color: var(--primary); background: #fff; box-shadow: 0 0 0 4px rgba(67, 56, 202, 0.1); }

        .btn-gen { width: 100%; padding: 1.2rem; border-radius: 1.5rem; border: none; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; font-weight: 800; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 1rem; }
        .btn-gen:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(67, 56, 202, 0.3); }

        /* MODUL STYLE */
        .modul-title { text-align: center; border-bottom: 4px double #000; padding-bottom: 10px; margin-bottom: 25px; line-height: 1.2; font-weight: bold; font-size: 14pt; text-decoration: underline; }
        .table-identitas { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .table-identitas td { padding: 4px 0; vertical-align: top; font-size: 11pt; border-bottom: 1px dotted #ccc; }
        
        .section-num { font-weight: bold; margin-top: 25px; display: block; font-size: 12pt; }
        .content-indent { margin-left: 20px; margin-bottom: 15px; font-size: 11pt; line-height: 1.7; }

        footer { text-align: center; padding: 60px 20px; color: #64748b; font-size: 0.85rem; font-weight: 700; }
        .dev-highlight { color: var(--primary); font-weight: 800; }
    </style>
</head>
<body>

    <header>
        <h1 style="font-size: 2.8rem; font-weight: 800;">Administrasi Guru Pintar</h1>
        <p style="letter-spacing: 3px; font-weight: 300; text-transform: uppercase;">"PM & KBC KMA No. 450 Tahun 2024 Professional Edition"</p>
    </header>

    <div class="main-container">
        <aside class="sidebar">
            <h3 style="margin-bottom: 25px; font-weight: 800; color: var(--primary); border-left: 5px solid var(--secondary); padding-left: 15px;">Administrasi Guru Pintar</h3>
            
            <label class="form-label">Identitas Penyusun</label>
            <input type="text" id="nama" class="input-control" placeholder="Nama Lengkap & Gelar">
            <input type="text" id="sekolah" class="input-control" placeholder="Nama Madrasah (MI/MTs/MA)">

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div>
                    <label class="form-label">Tahun Pelajaran</label>
                    <select id="tahun" class="input-control">
                        <option>2024/2025</option><option selected>2025/2026</option>
                        <option>2026/2027</option><option>2027/2028</option>
                        <option>2028/2029</option><option>2029/2030</option><option>2030/2031</option>
                    </select>
                </div>
                <div>
                    <label class="form-label">Semester</label>
                    <select id="semester" class="input-control"><option>1 (Ganjil)</option><option>2 (Genap)</option></select>
                </div>
            </div>

            <label class="form-label">Jenjang Pendidikan</label>
            <select id="jenjang" class="input-control" onchange="updateFase()">
                <option value="SD_MI">SD / MI</option>
                <option value="SMP_MTS">SMP / MTs</option>
                <option value="SMA_MA">SMA / MA</option>
            </select>

            <label class="form-label">Fase / Kelas</label>
            <select id="fase_kelas" class="input-control"></select>

            <label class="form-label">Mata Pelajaran</label>
            <select id="mapel" class="input-control"></select>

            <label class="form-label">Topik Pembelajaran</label>
            <textarea id="materi" class="input-control" rows="2" placeholder="Contoh: Energi Terbarukan"></textarea>

            <button onclick="generate()" class="btn-gen"><i class="fas fa-file-signature"></i> GENERATE MODUL LENGKAP</button>
        </aside>

        <section class="preview-section">
            <div id="editor" contenteditable="true" class="paper-shadow">
                <div style="text-align:center; color:#cbd5e1; margin-top:120mm;">
                    <i class="fas fa-print" style="font-size: 5rem; margin-bottom: 20px;"></i>
                    <p>Format Pembelajaran Mendalam (PM) & KBC siap dibuat secara simetris.</p>
                </div>
            </div>
            
            <button onclick="saveWord()" class="btn-gen" style="background: #059669; margin-top: 2rem; width: 210mm;">
                <i class="fas fa-file-word"></i> DOWNLOAD MODUL (.DOCX)
            </button>
        </section>
    </div>

    <footer>
        <p>Administrasi Guru Pintar &copy; 2026 | Galeri Famous Project</p>
        <p style="font-size: 0.7rem; opacity: 0.8; margin-top: 5px;">Developed by <span class="dev-highlight">Galeri Famous Project</span> â€¢ Brebes, Indonesia</p>
    </footer>

    <script>
        const database = {
            "SD_MI": { 
                fase: ["Fase A - Kelas 1", "Fase A - Kelas 2", "Fase B - Kelas 3", "Fase B - Kelas 4", "Fase C - Kelas 5", "Fase C - Kelas 6"],
                mapel: ["IPAS", "Bahasa Indonesia", "Matematika", "Pancasila", "Al-Qur'an Hadis", "Akidah Akhlak", "Fikih", "SKI", "Bahasa Arab", "Ke-NU-an", "BTQ"] 
            },
            "SMP_MTS": { 
                fase: ["Fase D - Kelas 7", "Fase D - Kelas 8", "Fase D - Kelas 9"],
                mapel: ["IPA", "IPS", "Fisika", "Bahasa Indonesia", "Matematika", "Bahasa Inggris", "Informatika", "Pancasila", "Fikih", "Al-Qur'an Hadis", "Akidah Akhlak", "SKI", "Bahasa Arab"] 
            },
            "SMA_MA": { 
                fase: ["Fase E - Kelas 10", "Fase F - Kelas 11", "Fase F - Kelas 12"],
                mapel: ["Bahasa Indonesia", "Matematika", "Bahasa Inggris", "Sejarah", "Biologi", "Fisika", "Kimia", "Ekonomi", "Sosiologi", "Fikih", "Ushul Fikih", "Bahasa Arab"] 
            }
        };

        function updateFase() {
            const jenjang = document.getElementById('jenjang').value;
            const faseSelect = document.getElementById('fase_kelas');
            const mapelSelect = document.getElementById('mapel');
            
            faseSelect.innerHTML = database[jenjang].fase.map(f => `<option>${f}</option>`).join("");
            mapelSelect.innerHTML = database[jenjang].mapel.map(m => `<option>${m}</option>`).join("");
        }
        updateFase();

        function generate() {
            const v = (id) => document.getElementById(id).value;
            if(!v('nama') || !v('materi')) return alert("Mohon lengkapi Nama dan Topik!");

            const html = `
                <div class="modul-title">MODUL AJAR PEMBELAJARAN MENDALAM+KBC (PjBL)</div>

                <table class="table-identitas">
                    <tr><td width="20%">Penyusun</td><td width="30%">: ${v('nama')}</td><td width="20%">Fase/Kelas</td><td width="30%">: ${v('fase_kelas')}</td></tr>
                    <tr><td>Mata Pelajaran</td><td>: ${v('mapel')}</td><td>Madrasah</td><td>: ${v('sekolah')}</td></tr>
                    <tr><td>Materi</td><td>: ${v('materi')}</td><td>Alokasi Waktu</td><td>: 8 JP (4 Pertemuan)</td></tr>
                    <tr><td>Tahun Pelajaran</td><td>: ${v('tahun')}</td><td>Semester</td><td>: ${v('semester')}</td></tr>
                </table>

                <span class="section-num">1. Identifikasi Profil Murid</span>
                <p class="content-indent">Peserta didik pada kelas ini secara umum telah mengenal konsep dasar <strong>${v('materi')}</strong> dari pengalaman sehari-hari, namun pemahaman mereka masih bersifat parsial. Berdasarkan hasil asesmen diagnostik, murid menunjukkan minat tinggi pada media konkret. Strategi pembelajaran akan difokuskan pada eksplorasi mandiri guna membangun pemahaman utuh antara teori dengan potensi lokal di sekitar sekolah atau desa tempat tinggal mereka.</p>

                <span class="section-num">2. Identifikasi Materi Pelajaran</span>
                <p class="content-indent">Materi <strong>${v('materi')}</strong> dirancang untuk menghubungkan konsep saintifik dengan realitas kehidupan nyata. Melalui Pembelajaran Mendalam, siswa diarahkan untuk tidak sekadar menghafal, melainkan mampu mengidentifikasi masalah nyata di lingkungan Madrasah dan menawarkan solusi alternatif berbasis kearifan lokal.</p>

                <span class="section-num">3. Dimensi Profil Lulusan (DPL) dan Tema KBC</span>
                <div class="content-indent">
                    DPL Berbasis PM:<br>1) <b>Penalaran Kritis:</b> Memproses informasi secara akurat.<br>2) <b>Kreativitas:</b> Menghasilkan gagasan orisinal.<br>3) <b>Kolaborasi:</b> Membangun tim kerja yang solid.<br><br>
                    Tema KBC:<br>1) <i>Hubbunnas</i> (Cinta kepada Sesama)<br>2) <i>Hubbul Biah</i> (Cinta kepada Lingkungan)
                </div>

                <span style="font-weight:bold; text-decoration:underline; font-size:12pt; display:block; margin-top:20px;">LANGKAH-LANGKAH PEMBELAJARAN (INTI)</span>
                
                <span class="sub-header" style="font-weight:bold; margin-top:10px; display:block;">A. Memahami (Bermakna, Hubbul Biah)</span>
                <div class="content-indent">
                    - Murid melakukan literasi mendalam mengenai <strong>${v('materi')}</strong> melalui berbagai sumber autentik.<br>
                    - Membangun peta konsep yang menghubungkan materi dengan tanggung jawab menjaga kelestarian alam sebagai wujud syukur.
                </div>

                <span class="sub-header" style="font-weight:bold; margin-top:10px; display:block;">B. Mengaplikasi (Hubbunnas, Proyek Terpadu)</span>
                <div class="content-indent">
                    - Murid melakukan kunjungan lapangan untuk mengidentifikasi tantangan nyata terkait <strong>${v('materi')}</strong> di desa sekitar.<br>
                    - Merancang proyek solusi bersama kelompok dengan menjunjung tinggi nilai kasih sayang dan kepedulian antar sesama teman.
                </div>

                <span class="sub-header" style="font-weight:bold; margin-top:10px; display:block;">C. Merefleksi (Berkesadaran)</span>
                <div class="content-indent">
                    - Menyajikan hasil proyek dan mendiskusikan umpan balik yang membangun.<br>
                    - Menyusun jurnal refleksi individu tentang bagaimana ilmu <strong>${v('materi')}</strong> diaplikasikan dalam perilaku sehari-hari (Aksi Nyata).
                </div>

                <br><br>
                <table style="width:100%; text-align:center;">
                    <tr>
                        <td width="50%">Mengetahui,<br>Kepala Madrasah<br><br><br><br>____________________</td>
                        <td>Brebes, ${new Date().toLocaleDateString('id-ID', {day: 'numeric', month: 'long', year: 'numeric'})}<br>Guru Mata Pelajaran<br><br><br><br><strong>${v('nama')}</strong></td>
                    </tr>
                </table>
            `;
            document.getElementById('editor').innerHTML = html;
        }

        async function saveWord() {
            const { Document, Packer, Paragraph, TextRun, AlignmentType } = docx;
            const editorText = document.getElementById('editor').innerText;
            const lines = editorText.split('\n').filter(l => l.trim() !== "");
            
            const doc = new Document({
                sections: [{
                    children: lines.map(line => new Paragraph({
                        children: [new TextRun({ text: line, size: 24, font: "Times New Roman" })],
                        spacing: { after: 120 }, alignment: AlignmentType.JUSTIFY
                    }))
                }]
            });
            const blob = await Packer.toBlob(doc);
            saveAs(blob, `Modul_PM_KBC_Lengkap.docx`);
        }
    </script>
</body>
</html>
