<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administrasi Guru Pintar - Galeri Famous Project</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        :root { --primary: #4338ca; --secondary: #db2777; --bg: #e2e8f0; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: #1e293b; line-height: 1.5; }

        header {
            background: linear-gradient(-45deg, #4338ca, #6366f1, #db2777, #ec4899);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            padding: 3rem 2rem 6rem; text-align: center; color: white;
            border-bottom: 4px solid rgba(255, 255, 255, 0.1);
        }
        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        .main-container {
            max-width: 1600px; margin: -4rem auto 4rem; padding: 0 2rem;
            display: flex; justify-content: center; align-items: flex-start; gap: 2.5rem;
        }

        @media (max-width: 1250px) {
            .main-container { flex-direction: column; align-items: center; margin-top: -2rem; }
            .sidebar { width: 100% !important; max-width: 600px; position: static !important; }
        }

        .sidebar {
            width: 420px; background: white; border-radius: 2rem; padding: 2.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1); position: sticky; top: 2rem; flex-shrink: 0;
        }

        .preview-section { flex-grow: 1; display: flex; flex-direction: column; align-items: center; width: 100%; }

        .paper-shadow {
            background: white; width: 210mm; min-height: 297mm; padding: 25mm;
            box-shadow: 0 0 50px rgba(0,0,0,0.15); font-family: 'Times New Roman', serif;
            color: #000; outline: none; border-radius: 2px; text-align: justify;
        }

        .form-label { display: block; font-size: 0.75rem; font-weight: 800; color: #64748b; margin-bottom: 0.5rem; text-transform: uppercase; }
        .input-control { width: 100%; padding: 0.9rem; border-radius: 1rem; border: 2px solid #f1f5f9; background: #fcfcfc; margin-bottom: 1.2rem; outline: none; font-size: 0.9rem; transition: 0.3s; }

        .btn-gen { width: 100%; padding: 1.2rem; border-radius: 1.5rem; border: none; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; font-weight: 800; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 1rem; }
        .btn-gen:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(67, 56, 202, 0.3); }

        /* DESIGN RENDER (DETAIL & BERWARNA) */
        .render-header { border: 4px double var(--primary); padding: 20px; margin-bottom: 25px; text-align: center; border-radius: 10px; background: #f8fafc; }
        .render-title { font-size: 16pt; font-weight: bold; color: var(--primary); text-transform: uppercase; margin-bottom: 5px; text-decoration: underline; }
        .render-subtitle { font-size: 11pt; color: #475569; font-weight: 600; border-top: 1px solid #cbd5e1; padding-top: 8px; }
        
        .render-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .render-table td { border: 1px solid #000; padding: 6px 10px; font-size: 11pt; }
        .label-cell { background: #f3f4f6; font-weight: bold; width: 22%; }
        
        .section-num { font-weight: bold; margin-top: 20px; display: block; font-size: 12pt; }
        .content-indent { margin-left: 20px; margin-bottom: 15px; font-size: 11pt; line-height: 1.7; text-align: justify; }
        .highlight-green { background: #f0fdf4; border: 1px solid #bbf7d0; padding: 15px; border-radius: 8px; color: #166534; margin: 15px 0; }

        footer { text-align: center; padding: 60px 20px; color: #64748b; font-size: 0.85rem; font-weight: 700; }
        .dev-highlight { color: var(--primary); font-weight: 800; }
    </style>
</head>
<body>

    <header>
        <h1 style="font-size: 2.8rem; font-weight: 800;">Administrasi Guru Pintar</h1>
        <p style="letter-spacing: 2px; font-weight: 300; text-transform: uppercase;">"Membangun Masa Depan Melalui Pembelajaran Mendalam & Karakter Berbasis Cinta"</p>
    </header>

    <div class="main-container">
        <aside class="sidebar">
            <h3 style="margin-bottom: 25px; font-weight: 800; color: var(--primary); border-left: 5px solid var(--secondary); padding-left: 15px;">Administrasi Guru Pintar</h3>
            
            <label class="form-label">Identitas Penyusun</label>
            <input type="text" id="nama" class="input-control" placeholder="Nama Lengkap & Gelar">
            <input type="text" id="sekolah" class="input-control" placeholder="Nama Madrasah">

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div>
                    <label class="form-label">Tahun Pelajaran</label>
                    <select id="tahun" class="input-control">
                        <option>2024/2025</option><option selected>2025/2026</option>
                        <option>2026/2027</option><option>2027/2028</option>
                        <option>2028/2029</option><option>2029/2030</option><option>2030/2031</option>
                    </select>
                </div>
                <div>
                    <label class="form-label">Semester</label>
                    <select id="semester" class="input-control"><option>1 (Ganjil)</option><option>2 (Genap)</option></select>
                </div>
            </div>

            <label class="form-label">Jenjang Pendidikan</label>
            <select id="jenjang" class="input-control" onchange="updateFase()">
                <option value="SD_MI">SD / MI</option>
                <option value="SMP_MTS">SMP / MTs</option>
                <option value="SMA_MA">SMA / MA</option>
            </select>

            <label class="form-label">Fase / Kelas</label>
            <select id="fase_kelas" class="input-control"></select>

            <label class="form-label">Mata Pelajaran</label>
            <select id="mapel" class="input-control"></select>

            <label class="form-label">Topik Utama Pembelajaran</label>
            <textarea id="materi" class="input-control" rows="2" placeholder="Contoh: Energi Terbarukan"></textarea>

            <button onclick="generate()" class="btn-gen"><i class="fas fa-magic"></i> GENERATE MODUL LENGKAP</button>
        </aside>

        <section class="preview-section">
            <div id="editor" contenteditable="true" class="paper-shadow">
                <div style="text-align:center; color:#cbd5e1; margin-top:120mm;">
                    <i class="fas fa-file-invoice" style="font-size: 5rem; margin-bottom: 20px;"></i>
                    <p>Isi data untuk menghasilkan Modul Ajar versi tebal & sangat detail.</p>
                </div>
            </div>
            
            <button onclick="saveWord()" class="btn-gen" style="background: #059669; margin-top: 2rem; width: 210mm;">
                <i class="fas fa-file-word"></i> DOWNLOAD MODUL (.DOCX)
            </button>
        </section>
    </div>

    <footer>
        <p>Administrasi Guru Pintar &copy; 2026 | Galeri Famous Project</p>
        <p style="font-size: 0.7rem; opacity: 0.8; margin-top: 5px;">Developed by <span class="dev-highlight">Galeri Famous Project</span> â€¢ Brebes, Indonesia</p>
    </footer>

    <script>
        const database = {
            "SD_MI": { 
                fase: ["Fase A - Kelas 1", "Fase A - Kelas 2", "Fase B - Kelas 3", "Fase B - Kelas 4", "Fase C - Kelas 5", "Fase C - Kelas 6"],
                mapel: ["IPAS", "Bahasa Indonesia", "Matematika", "Pancasila", "Al-Qur'an Hadis", "Akidah Akhlak", "Fikih", "SKI"] 
            },
            "SMP_MTS": { 
                fase: ["Fase D - Kelas 7", "Fase D - Kelas 8", "Fase D - Kelas 9"],
                mapel: ["IPA", "IPS", "Fisika", "Bahasa Indonesia", "Matematika", "Bahasa Inggris", "Fikih", "Al-Qur'an Hadis", "SKI"] 
            },
            "SMA_MA": { 
                fase: ["Fase E - Kelas 10", "Fase F - Kelas 11", "Fase F - Kelas 12"],
                mapel: ["Bahasa Indonesia", "Matematika", "Bahasa Inggris", "Sejarah", "Biologi", "Fisika", "Kimia", "Ekonomi", "Sosiologi", "Fikih", "Ushul Fikih", "Bahasa Arab"] 
            }
        };

        function updateFase() {
            const jenjang = document.getElementById('jenjang').value;
            const faseSelect = document.getElementById('fase_kelas');
            const mapelSelect = document.getElementById('mapel');
            faseSelect.innerHTML = database[jenjang].fase.map(f => `<option>${f}</option>`).join("");
            mapelSelect.innerHTML = database[jenjang].mapel.map(m => `<option>${m}</option>`).join("");
        }
        updateFase();

        function generate() {
            const v = (id) => document.getElementById(id).value;
            if(!v('nama') || !v('materi')) return alert("Mohon lengkapi data!");

            const html = `
                <div class="render-header">
                    <div class="render-title">MODUL AJAR PEMBELAJARAN MENDALAM+KBC (PjBL)</div>
                    <div class="render-subtitle">Implementasi Kurikulum Merdeka Berbasis Karakter & Cinta Lingkungan</div>
                </div>

                <table class="render-table">
                    <tr><td class="label-cell">Penyusun</td><td>${v('nama')}</td><td class="label-cell">Fase/Kelas</td><td>${v('fase_kelas')}</td></tr>
                    <tr><td class="label-cell">Mata Pelajaran</td><td>${v('mapel')}</td><td class="label-cell">Madrasah</td><td>${v('sekolah')}</td></tr>
                    <tr><td class="label-cell">Materi</td><td>${v('materi')}</td><td class="label-cell">Alokasi Waktu</td><td>8 JP (4 Pertemuan)</td></tr>
                    <tr><td class="label-cell">Tahun Pelajaran</td><td>${v('tahun')}</td><td class="label-cell">Semester</td><td>${v('semester')}</td></tr>
                </table>

                <span class="section-num">1. Identifikasi Profil Murid</span>
                <p class="content-indent">Peserta didik pada satuan pendidikan ini memiliki latar belakang pemahaman awal yang bervariasi mengenai konsep <strong>${v('materi')}</strong>. Berdasarkan observasi, murid mengenal istilah tersebut secara umum namun belum mampu membedah variabel fungsionalnya secara utuh (miskonsepsi pada sumber dan dampak). Murid menunjukkan minat tinggi pada media visual dan eksperimen langsung. Oleh karena itu, modul ini dirancang untuk menjembatani pengetahuan permukaan menuju pemahaman mendalam (Deep Learning) melalui konteks lokal di sekitar Madrasah agar tumbuh kesadaran kritis dan empati.</p>

                <span class="section-num">2. Identifikasi Materi Pelajaran</span>
                <p class="content-indent">Topik <strong>${v('materi')}</strong> mengandung elemen esensial yang memerlukan media konkret guna memperkuat kognisi siswa. Materi ini tidak diajarkan sebagai hafalan statis, melainkan sebagai instrumen untuk mengidentifikasi masalah nyata di lingkungan sekolah atau desa. Fokus materi diarahkan pada analisis potensi energi/konsep lokal, sehingga murid merasa bahwa ilmu yang dipelajari memiliki kegunaan nyata (Authentic Learning) dalam memperbaiki kualitas ekosistem hidup.</p>

                <span class="section-num">3. Dimensi Profil Lulusan (DPL) dan Tema KBC</span>
                <div class="content-indent">
                    <b>Dimensi Profil Lulusan (DPL):</b><br>
                    1) <b>Penalaran Kritis:</b> Murid mampu mengidentifikasi, memproses, serta mengevaluasi informasi secara objektif.<br>
                    2) <b>Kreativitas:</b> Murid menghasilkan gagasan orisinal dan solusi alternatif dalam pemecahan masalah.<br>
                    3) <b>Kolaborasi:</b> Murid mampu bekerja sama dalam tim dengan menjunjung tinggi empati.<br>
                    4) <b>Komunikasi:</b> Murid mampu menyampaikan pikiran dan perasaan secara jelas serta beradab.<br><br>
                    <b>Tema Karakter Berbasis Cinta (KBC):</b><br>
                    1) <b><i>Hubbunnas</i> (Cinta Sesama):</b> Menumbuhkan perilaku beradab dan kepedulian sosial dalam tim.<br>
                    2) <b><i>Hubbul Biah</i> (Cinta Lingkungan):</b> Membangun kesadaran menjaga kelestarian alam sebagai wujud syukur kepada Allah SWT.
                </div>

                <span class="section-num">4. Capaian Pembelajaran & Lintas Disiplin Ilmu</span>
                <p class="content-indent">Peserta didik menyelidiki berbagai aspek terkait <strong>${v('materi')}</strong> melalui pengumpulan data primer dan sekunder. Pembelajaran ini mengintegrasikan disiplin ilmu seperti <b>IPA/Fisika</b> (konsep inti), <b>Matematika</b> (pengolahan data), <b>TIK</b> (literasi digital), dan <b>Aqidah Akhlak</b> (tinjauan etika <i>Hubbul Biah</i>).</p>

                <span class="section-num" style="text-decoration:underline;">LANGKAH-LANGKAH PEMBELAJARAN (ALUR MERDEKA - PM)</span>
                
                <span class="sub-header" style="font-weight:bold; display:block; margin-top:10px;">A. Memahami (Deep Understanding, Hubbul Biah)</span>
                <div class="content-indent">
                    1. Guru membuka dengan pertanyaan pemantik yang menggugah nalar: <i>"Apa yang terjadi jika konsep ${v('materi')} tidak dikelola dengan benar?"</i>.<br>
                    2. Murid melakukan eksplorasi literasi mendalam melalui artikel, e-book, dan jurnal digital mengenai <strong>${v('materi')}</strong>.<br>
                    3. Peserta didik membuat Peta Konsep (Mind Map) komprehensif yang menghubungkan materi dengan kelangsungan hidup lingkungan sekitar.
                </div>

                <span class="sub-header" style="font-weight:bold; display:block; margin-top:10px;">B. Mengaplikasi (Project Based Learning, Hubbunnas)</span>
                <div class="content-indent">
                    1. Murid melakukan kunjungan lapangan atau observasi di desa sekitar untuk mengidentifikasi masalah terkait <strong>${v('materi')}</strong>.<br>
                    2. Berkolaborasi dengan teman sejawat dan narasumber lokal untuk merancang prototipe atau rencana aksi solusi alternatif berbasis lingkungan.<br>
                    3. Guru membimbing proses kolaborasi agar tetap mengedepankan nilai cinta sesama (Hubbunnas) dan sikap saling menghargai.
                </div>

                <span class="sub-header" style="font-weight:bold; display:block; margin-top:10px;">C. Merefleksi (Metakognisi, Berkesadaran)</span>
                <div class="content-indent">
                    1. Murid menyajikan hasil proyek dalam pameran kelas dan menerima umpan balik (feedback) dari guru serta rekan sejawat.<br>
                    2. Peserta didik menyusun jurnal refleksi individu tentang kebermaknaan ilmu <strong>${v('materi')}</strong> dan komitmen aksi nyata di masa depan.<br>
                    3. Guru melakukan penguatan (deepening session) untuk meluruskan miskonsepsi dan memuliakan capaian belajar siswa.
                </div>

                <span class="section-num">5. Asesmen & Penutup</span>
                <div class="content-indent">
                    - <b>Asesmen Awal:</b> Pemetaan kesiapan kognitif dan gaya belajar siswa.<br>
                    - <b>Asesmen Proses:</b> Penilaian kinerja proyek, observasi profil karakter, dan rubrik kolaborasi.<br>
                    - <b>Asesmen Akhir:</b> Tes tertulis berbasis HOTS dan jurnal reflektif.<br>
                    <b>Penutup:</b> Guru memberikan apresiasi tulus atas kegigihan murid dan menutup dengan doa bersama (Berkesadaran).
                </div>

                <br><br>
                <table style="width:100%; text-align:center;">
                    <tr>
                        <td width="50%">Mengetahui,<br>Kepala Madrasah<br><br><br><br>____________________</td>
                        <td>Brebes, ${new Date().toLocaleDateString('id-ID', {day: 'numeric', month: 'long', year: 'numeric'})}<br>Guru Mata Pelajaran<br><br><br><br><strong>${v('nama')}</strong></td>
                    </tr>
                </table>
            `;
            document.getElementById('editor').innerHTML = html;
        }

        async function saveWord() {
            const { Document, Packer, Paragraph, TextRun, AlignmentType } = docx;
            const editorText = document.getElementById('editor').innerText;
            const lines = editorText.split('\n').filter(l => l.trim() !== "");
            
            const doc = new Document({
                sections: [{
                    children: lines.map(line => new Paragraph({
                        children: [new TextRun({ text: line, size: 24, font: "Times New Roman" })],
                        spacing: { after: 120 }, alignment: AlignmentType.JUSTIFY
                    }))
                }]
            });
            const blob = await Packer.toBlob(doc);
            saveAs(blob, `Modul_Lengkap_PM_KBC.docx`);
        }
    </script>
</body>
</html>
