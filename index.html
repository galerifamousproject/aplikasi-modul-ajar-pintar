<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administrasi Guru Pintar - Galeri Famous Project</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        :root { --primary: #4338ca; --secondary: #db2777; --bg: #e2e8f0; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: #1e293b; line-height: 1.5; }

        header {
            background: linear-gradient(-45deg, #4338ca, #6366f1, #db2777, #ec4899);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            padding: 3rem 2rem 6rem; text-align: center; color: white;
            border-bottom: 4px solid rgba(255, 255, 255, 0.1);
        }
        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        .main-container {
            max-width: 1600px; margin: -4rem auto 4rem; padding: 0 2rem;
            display: flex; justify-content: center; align-items: flex-start; gap: 2.5rem;
        }

        @media (max-width: 1250px) {
            .main-container { flex-direction: column; align-items: center; margin-top: -2rem; }
            .sidebar { width: 100% !important; max-width: 600px; position: static !important; }
        }

        .sidebar {
            width: 420px; background: white; border-radius: 2rem; padding: 2.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1); position: sticky; top: 2rem; flex-shrink: 0;
        }

        .preview-section { flex-grow: 1; display: flex; flex-direction: column; align-items: center; width: 100%; }

        .paper-shadow {
            background: white; width: 210mm; min-height: 297mm; padding: 20mm 25mm;
            box-shadow: 0 0 50px rgba(0,0,0,0.15); font-family: 'Times New Roman', serif;
            color: #000; outline: none; border-radius: 2px; text-align: justify;
        }

        .form-label { display: block; font-size: 0.75rem; font-weight: 800; color: #64748b; margin-bottom: 0.5rem; text-transform: uppercase; }
        .input-control { width: 100%; padding: 0.9rem; border-radius: 1rem; border: 2px solid #f1f5f9; background: #fcfcfc; margin-bottom: 1.2rem; outline: none; font-size: 0.9rem; }

        .btn-gen { width: 100%; padding: 1.2rem; border-radius: 1.5rem; border: none; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; font-weight: 800; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 1rem; }
        
        /* STYLE TEKS MODUL */
        .m-title { text-align: center; font-weight: bold; font-size: 14pt; text-decoration: underline; margin-bottom: 20px; text-transform: uppercase; }
        .m-table { width: 100%; margin-bottom: 15px; font-size: 11pt; border-bottom: 2px solid #000; padding-bottom: 10px; }
        .m-section { font-weight: bold; margin-top: 15px; display: block; font-size: 11pt; }
        .m-content { margin-left: 15px; margin-bottom: 10px; font-size: 11pt; line-height: 1.6; }

        footer { text-align: center; padding: 60px 20px; color: #64748b; font-size: 0.85rem; font-weight: 700; }
    </style>
</head>
<body>

    <header>
        <h1 style="font-size: 2.8rem; font-weight: 800;">Administrasi Guru Pintar</h1>
        <p style="letter-spacing: 2px; font-weight: 300; text-transform: uppercase;">"Membangun Masa Depan Melalui Pembelajaran Mendalam & Karakter Berbasis Cinta"</p>
    </header>

    <div class="main-container">
        <aside class="sidebar">
            <h3 style="margin-bottom: 25px; font-weight: 800; color: var(--primary); border-left: 5px solid var(--secondary); padding-left: 15px;">Administrasi Guru Pintar</h3>
            
            <label class="form-label">Identitas Penyusun</label>
            <input type="text" id="nama" class="input-control" placeholder="Nama Lengkap & Gelar">
            <input type="text" id="sekolah" class="input-control" placeholder="Nama Madrasah">

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div>
                    <label class="form-label">Tahun Pelajaran</label>
                    <select id="tahun" class="input-control">
                        <option>2024/2025</option><option selected>2025/2026</option>
                        <option>2026/2027</option><option>2027/2028</option>
                        <option>2028/2029</option><option>2029/2030</option><option>2030/2031</option>
                    </select>
                </div>
                <div>
                    <label class="form-label">Semester</label>
                    <select id="semester" class="input-control"><option>1 (Ganjil)</option><option>2 (Genap)</option></select>
                </div>
            </div>

            <label class="form-label">Jenjang Pendidikan</label>
            <select id="jenjang" class="input-control" onchange="updateFase()">
                <option value="SD_MI">SD / MI</option>
                <option value="SMP_MTS">SMP / MTs</option>
                <option value="SMA_MA">SMA / MA</option>
            </select>

            <label class="form-label">Fase / Kelas</label>
            <select id="fase_kelas" class="input-control"></select>

            <label class="form-label">Mata Pelajaran</label>
            <select id="mapel" class="input-control"></select>

            <label class="form-label">Topik Utama Pembelajaran</label>
            <textarea id="materi" class="input-control" rows="2" placeholder="Contoh: Energi Terbarukan"></textarea>

            <button onclick="generate()" class="btn-gen"><i class="fas fa-magic"></i> GENERATE MODUL LENGKAP</button>
        </aside>

        <section class="preview-section">
            <div id="editor" contenteditable="true" class="paper-shadow">
                <div style="text-align:center; color:#cbd5e1; margin-top:120mm;">
                    <i class="fas fa-file-invoice" style="font-size: 5rem; margin-bottom: 20px;"></i>
                    <p>Modul Ajar Pembelajaran Mendalam (PM) & Karakter Berbasis Cinta (KBC).</p>
                </div>
            </div>
            <button onclick="saveWord()" class="btn-gen" style="background: #059669; margin-top: 2rem; width: 210mm;"><i class="fas fa-file-word"></i> DOWNLOAD MODUL (.DOCX)</button>
        </section>
    </div>

    <footer>
        <p>Administrasi Guru Pintar &copy; 2026 | Galeri Famous Project</p>
        <p style="font-size: 0.7rem; opacity: 0.8; margin-top: 5px;">Developed by Galeri Famous Project â€¢ Brebes, Indonesia</p>
    </footer>

    <script>
        const database = {
            "SD_MI": { fase: ["Fase A - Kelas 1", "Fase B - Kelas 4", "Fase C - Kelas 6"], mapel: ["IPAS", "Matematika", "Fikih"] },
            "SMP_MTS": { fase: ["Fase D - Kelas 7", "Fase D - Kelas 8"], mapel: ["IPA", "Fisika", "Bahasa Inggris"] },
            "SMA_MA": { fase: ["Fase E - Kelas 10", "Fase F - Kelas 11"], mapel: ["Biologi", "Kimia", "Fikih"] }
        };

        function updateFase() {
            const jenjang = document.getElementById('jenjang').value;
            document.getElementById('fase_kelas').innerHTML = database[jenjang].fase.map(f => `<option>${f}</option>`).join("");
            document.getElementById('mapel').innerHTML = database[jenjang].mapel.map(m => `<option>${m}</option>`).join("");
        }
        updateFase();

        function generate() {
            const v = (id) => document.getElementById(id).value;
            const html = `
                <div class="m-title">MODUL AJAR PEMBELAJARAN MENDALAM+KBC (PjBL)</div>
                <table class="m-table">
                    <tr><td width="20%">Penyusun</td><td width="30%">: ${v('nama')}</td><td width="20%">Fase/Kelas</td><td>: ${v('fase_kelas')}</td></tr>
                    <tr><td>Mata Pelajaran</td><td>: ${v('mapel')}</td><td>Madrasah</td><td>: ${v('sekolah')}</td></tr>
                    <tr><td>Materi</td><td>: ${v('materi')}</td><td>Alokasi Waktu</td><td>: 8 JP (4 Pertemuan)</td></tr>
                    <tr><td>Tahun Pelajaran</td><td>: ${v('tahun')}</td><td>Semester</td><td>: ${v('semester')}</td></tr>
                </table>

                <span class="m-section">1. Identifikasi Profil Murid</span>
                <p class="m-content">Murid pada kelas ini memiliki karakteristik perkembangan yang sangat beragam. Sebagian besar murid telah mengenal konsep dasar <strong>${v('materi')}</strong> dalam kehidupan sehari-hari namun belum memahami secara utuh variabel fungsionalnya. Melalui asesmen awal, ditemukan bahwa murid lebih antusias pada media konkret (simulasi digital/eksperimen) untuk menjembatani miskonsepsi menuju pemahaman mendalam (Deep Learning).</p>

                <span class="m-section">2. Identifikasi Materi Pelajaran</span>
                <p class="m-content">Topik <strong>${v('materi')}</strong> dirancang untuk tidak sekadar transfer teori, melainkan sebagai instrumen bagi siswa untuk mengidentifikasi potensi lokal di sekitar madrasah atau tempat tinggal mereka. Penggunaan media gambar dan simulasi menjadi krusial agar siswa mampu membedakan aspek fungsional secara mendalam dan beretika.</p>

                <span class="m-section">3. Dimensi Profil Lulusan (DPL) dan Tema KBC</span>
                <p class="m-content"><b>DPL:</b> 1) Penalaran Kritis, 2) Kreativitas, 3) Kolaborasi, 4) Komunikasi.<br><b>Tema KBC:</b> 1) <i>Hubbunnas</i> (Cinta Sesama), 2) <i>Hubbul Biah</i> (Cinta Lingkungan).</p>

                <span class="m-section">4. Capaian Pembelajaran</span>
                <p class="m-content">Peserta didik menyelidiki fenomena <strong>${v('materi')}</strong>, prinsip kerja sistem, serta penerapan teknologi secara berkelanjutan. Murid diharapkan mampu menganalisis dampak ketersediaan energi/sumber daya terhadap lingkungan dan ekonomi lokal.</p>

                <span class="m-section">5. Lintas Disiplin Ilmu</span>
                <p class="m-content">Mengintegrasikan mata pelajaran Matematika (statistika data), TIK (literasi digital), Qur'an Hadits (ayat pelestarian alam), dan Aqidah Akhlak (Hubbul Biah).</p>

                <span class="m-section">6. Topik Pembelajaran</span>
                <p class="m-content">Peserta didik menerapkan solusi inovatif berbasis materi <strong>${v('materi')}</strong> untuk memecahkan masalah ketersediaan sumber daya di lingkungan sekitar.</p>

                <span class="m-section">7. Tujuan Pembelajaran</span>
                <p class="m-content">Melalui pembelajaran Projek, murid mampu menganalisis bentuk energi/konsep yang terlibat, mengidentifikasi masalah ketersediaan di lingkungan, dan merancang prototipe solusi sederhana.</p>

                <span class="m-section">8. Praktik Pedagogis</span>
                <p class="m-content">Model: PjBL (Project Based Learning). Metode: Diskusi kelompok, eksplorasi lapangan, eksperimen, dan presentasi produk hasil kerja.</p>

                <span class="m-section">9. Mitra Pembelajaran</span>
                <p class="m-content">Guru bidang studi lain, petugas instansi terkait (PLN/PLTU), pengelola bank sampah, dan tokoh masyarakat sekitar madrasah.</p>

                <span class="m-section">10. Lingkungan Pembelajaran</span>
                <p class="m-content">Ruang fisik: Lingkungan desa/kecamatan setempat. Ruang virtual: LMS/Platform PHET simulasi. Budaya: Kolaboratif dan proaktif.</p>

                <span class="m-section">11. Pemanfaatan Digital</span>
                <p class="m-content">LMS, Google Form, Zoom/WhatsApp untuk koordinasi, video pembelajaran, dan Quizizz untuk asesmen interaktif.</p>

                <span class="m-section">12. Langkah-langkah Pembelajaran (Deep Learning)</span>
                <p class="m-content"><b>A. AWAL (Bermakna, Hubbul Biah):</b> Orientasi positif, sapaan ramah, pertanyaan pemantik: <i>"Apa yang terjadi jika sumber daya ini habis?"</i>, literasi digital mandiri, dan penentuan tujuan bersama.<br>
                <b>B. INTI (Memahami, Mengaplikasi):</b> Eksplorasi sumber informasi (e-book/buku), pembuatan peta konsep, kunjungan lapangan, interview masyarakat, dan perancangan proyek alternatif berbasis lingkungan.<br>
                <b>C. MEREFLEKSI (Berkesadaran):</b> Uji coba proyek, presentasi, umpan balik dari mitra, penyusunan jurnal refleksi individu, dan pencarian solusi peran lanjutan.</p>

                <span class="m-section">13. Asesmen Pembelajaran</span>
                <p class="m-content">Diagnostik: Pengetahuan awal. Formatif: Peta konsep dan performa diskusi. Sumatif: Jurnal reflektif dan tes tulis terstruktur.</p>

                <span class="m-section">14. Media/Sumber Pembelajaran</span>
                <p class="m-content">Laptop, PPT interaktif, Buku sumber utama, dan sumber rujukan internet terpercaya.</p>

                <br><br>
                <table style="width:100%; text-align:center;">
                    <tr><td width="50%">Kepala Madrasah<br><br><br><br>_________________</td>
                    <td>Brebes, ${new Date().toLocaleDateString('id-ID', {month:'long', year:'numeric'})}<br>Guru Mata Pelajaran<br><br><br><br><strong>${v('nama')}</strong></td></tr>
                </table>
            `;
            document.getElementById('editor').innerHTML = html;
        }

        async function saveWord() {
            const { Document, Packer, Paragraph, TextRun, AlignmentType } = docx;
            const editorText = document.getElementById('editor').innerText;
            const lines = editorText.split('\n').filter(l => l.trim() !== "");
            const doc = new Document({
                sections: [{
                    children: lines.map(line => new Paragraph({
                        children: [new TextRun({ text: line, size: 24, font: "Times New Roman" })],
                        spacing: { after: 120 }, alignment: AlignmentType.JUSTIFY
                    }))
                }]
            });
            const blob = await Packer.toBlob(doc);
            saveAs(blob, `Modul_Lengkap_PM_KBC.docx`);
        }
    </script>
</body>
</html>
