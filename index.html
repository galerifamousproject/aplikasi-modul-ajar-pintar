<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administrasi Guru Pintar - Galeri Famous Project</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        :root { --primary: #4338ca; --secondary: #db2777; --bg: #e2e8f0; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: #1e293b; overflow-x: hidden; }

        header {
            background: linear-gradient(-45deg, #4338ca, #6366f1, #db2777, #ec4899);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            padding: 3rem 2rem 6rem; text-align: center; color: white;
            border-bottom: 4px solid rgba(255, 255, 255, 0.1);
        }
        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        .main-container {
            max-width: 1450px; margin: -4rem auto 4rem; padding: 0 20px;
            display: grid; grid-template-columns: 420px 1fr; gap: 35px; align-items: start;
        }

        @media (max-width: 1250px) {
            .main-container { display: flex; flex-direction: column; align-items: center; }
            .sidebar { width: 100% !important; max-width: 600px; position: static !important; }
        }

        .sidebar { background: white; border-radius: 2rem; padding: 2.5rem; box-shadow: 0 20px 40px rgba(0,0,0,0.1); position: sticky; top: 2rem; }
        .preview-section { display: flex; flex-direction: column; align-items: center; width: 100%; }

        .paper-shadow {
            background: white; width: 210mm; min-height: 297mm; padding: 20mm 25mm;
            box-shadow: 0 0 50px rgba(0,0,0,0.15); font-family: 'Times New Roman', serif;
            color: #000; outline: none; text-align: justify;
        }

        .form-label { display: block; font-size: 0.75rem; font-weight: 800; color: #64748b; margin-bottom: 0.5rem; text-transform: uppercase; }
        .input-control { width: 100%; padding: 0.9rem; border-radius: 1rem; border: 2px solid #f1f5f9; background: #fcfcfc; margin-bottom: 1.2rem; outline: none; font-size: 0.9rem; transition: 0.3s; }
        .input-control:focus { border-color: var(--primary); box-shadow: 0 0 0 4px rgba(67, 56, 202, 0.1); }
        
        .btn-gen { width: 100%; padding: 1.2rem; border-radius: 1.5rem; border: none; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; font-weight: 800; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 1rem; transition: 0.3s; }
        .btn-gen:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(67, 56, 202, 0.3); }
        .btn-gen:disabled { opacity: 0.7; cursor: not-allowed; }

        .m-title { text-align: center; font-weight: bold; font-size: 14pt; text-decoration: underline; margin-bottom: 20px; text-transform: uppercase; }
        .m-table { width: 100%; margin-bottom: 15px; font-size: 11pt; border-bottom: 2px solid #000; padding-bottom: 10px; border-collapse: collapse; }
        .m-table td { padding: 4px 0; vertical-align: top; }
        .m-content { margin-top: 15px; font-size: 11pt; line-height: 1.6; }
        
        footer { text-align: center; padding: 60px 20px; color: #64748b; font-size: 0.85rem; font-weight: 700; }
        .dev-highlight { color: var(--primary); font-weight: 800; }
    </style>
</head>
<body>

    <header>
        <h1 style="font-size: 2.8rem; font-weight: 800;">Administrasi Guru Pintar</h1>
        <p style="letter-spacing: 2px; font-weight: 300; text-transform: uppercase;">"Membangun Masa Depan Melalui Pembelajaran Mendalam & Karakter Berbasis Cinta"</p>
    </header>

    <div class="main-container">
        <aside class="sidebar">
            <h3 style="margin-bottom: 25px; font-weight: 800; color: var(--primary); border-left: 5px solid var(--secondary); padding-left: 15px;">Data Administrasi</h3>
            
            <label class="form-label">Identitas Penyusun</label>
            <input type="text" id="nama" class="input-control" placeholder="Nama Lengkap & Gelar">
            <input type="text" id="sekolah" class="input-control" placeholder="Nama Madrasah">

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div>
                    <label class="form-label">Tahun Pelajaran</label>
                    <select id="tahun" class="input-control">
                        <option>2024/2025</option><option selected>2025/2026</option>
                        <option>2026/2027</option>
                    </select>
                </div>
                <div>
                    <label class="form-label">Semester</label>
                    <select id="semester" class="input-control"><option>1 (Ganjil)</option><option>2 (Genap)</option></select>
                </div>
            </div>

            <label class="form-label">Jenjang Pendidikan</label>
            <select id="jenjang" class="input-control" onchange="updateSelection()">
                <option value="SD_MI">SD / MI</option>
                <option value="SMP_MTS">SMP / MTs</option>
                <option value="SMA_MA">SMA / MA</option>
            </select>

            <label class="form-label">Fase / Kelas</label>
            <select id="fase_kelas" class="input-control"></select>

            <label class="form-label">Mata Pelajaran</label>
            <select id="mapel" class="input-control"></select>

            <label class="form-label">Topik Utama Pembelajaran</label>
            <textarea id="materi" class="input-control" rows="2" placeholder="Contoh: Energi Terbarukan"></textarea>

            <button id="generateBtn" onclick="generate()" class="btn-gen"><i class="fas fa-magic"></i> GENERATE MODUL LENGKAP</button>
        </aside>

        <section class="preview-section">
            <div id="editor" contenteditable="true" class="paper-shadow">
                <div style="text-align:center; color:#cbd5e1; margin-top:120mm;">
                    <i class="fas fa-microchip" style="font-size: 5rem; margin-bottom: 20px;"></i>
                    <p>Sistem AI Gemini siap menyusun modul untuk Anda.</p>
                </div>
            </div>
            <button onclick="saveWord()" class="btn-gen" style="background: #059669; margin-top: 2rem; width: 210mm;"><i class="fas fa-file-word"></i> DOWNLOAD MODUL (.DOCX)</button>
        </section>
    </div>

    <footer>
        <p>Administrasi Guru Pintar &copy; 2026 | Galeri Famous Project</p>
        <p style="font-size: 0.7rem; opacity: 0.8; margin-top: 5px;">Developed by <span class="dev-highlight">Galeri Famous Project</span> â€¢ Brebes, Indonesia</p>
    </footer>

    <script>
        const GEMINI_API_KEY = "AIzaSyD1nivanIbrQq0q2_HAF1U-uPyD-OXc5fA";

        // DATABASE KEMBALI LENGKAP 100%
        const database = {
            "SD_MI": { 
                fase: ["Fase A - Kelas 1", "Fase A - Kelas 2", "Fase B - Kelas 3", "Fase B - Kelas 4", "Fase C - Kelas 5", "Fase C - Kelas 6"], 
                mapel: ["IPAS", "Bahasa Indonesia", "Matematika", "Pancasila", "PJOK", "Seni Musik", "Seni Rupa", "Al-Qur'an Hadis", "Akidah Akhlak", "Fikih", "SKI", "Bahasa Arab", "Ke-NU-an", "BTQ", "Bahasa Jawa"] 
            },
            "SMP_MTS": { 
                fase: ["Fase D - Kelas 7", "Fase D - Kelas 8", "Fase D - Kelas 9"], 
                mapel: ["IPA", "IPS", "Bahasa Indonesia", "Matematika", "Bahasa Inggris", "Informatika", "Pancasila", "PJOK", "Seni Budaya", "Al-Qur'an Hadis", "Akidah Akhlak", "Fikih", "SKI", "Bahasa Arab", "Ke-NU-an", "BTQ", "Bahasa Jawa"] 
            },
            "SMA_MA": { 
                fase: ["Fase E - Kelas 10", "Fase F - Kelas 11", "Fase F - Kelas 12"], 
                mapel: ["Bahasa Indonesia", "Matematika", "Bahasa Inggris", "Sejarah", "Pancasila", "Biologi", "Fisika", "Kimia", "Ekonomi", "Sosiologi", "Geografi", "Fikih", "Ushul Fikih", "Akidah Akhlak", "Al-Qur'an Hadis", "SKI", "Ilmu Tafsir", "Bahasa Arab", "Ke-NU-an", "Bahasa Jawa"] 
            }
        };

        function updateSelection() {
            const jenjang = document.getElementById('jenjang').value;
            document.getElementById('fase_kelas').innerHTML = database[jenjang].fase.map(f => `<option>${f}</option>`).join("");
            document.getElementById('mapel').innerHTML = database[jenjang].mapel.map(m => `<option>${m}</option>`).join("");
        }
        updateSelection();

        async function generate() {
            const v = (id) => document.getElementById(id).value;
            const editor = document.getElementById('editor');
            const btn = document.getElementById('generateBtn');

            if(!v('nama') || !v('sekolah') || !v('materi')) {
                alert("Mohon lengkapi Identitas dan Topik!");
                return;
            }

            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> SEDANG MENYUSUN...';
            
            editor.innerHTML = `
                <div style="text-align:center; color:#4338ca; margin-top:100mm;">
                    <i class="fas fa-brain fa-spin" style="font-size: 5rem; margin-bottom: 25px;"></i>
                    <h2 style="font-weight:800;">MENGHUBUNGKAN KE GEMINI AI</h2>
                    <p style="font-size:1.1rem; color:#64748b;">Merancang materi mendalam untuk "${v('materi')}"...</p>
                </div>`;

            const prompt = `Anda adalah asisten guru profesional. Buatlah Modul Ajar Kurikulum Merdeka yang mendalam dan sinkron. DATA: Guru: ${v('nama')}, Sekolah: ${v('sekolah')}, Jenjang: ${v('jenjang')}, Fase: ${v('fase_kelas')}, Mapel: ${v('mapel')}, Topik: ${v('materi')}, Semester: ${v('semester')}, Tahun: ${v('tahun')}. ISI WAJIB: 1. Tujuan Pembelajaran. 2. Ringkasan Materi (Deep Learning). 3. Integrasi Karakter KBC (Hubbul Biah & Hubbunnas). 4. Skenario PjBL konkret. 5. Asesmen. FORMAT: Bahasa Indonesia formal, gunakan <b> untuk judul poin, JANGAN pakai tanda bintang. Langsung ke isi modul.`;

            try {
                // MENGGUNAKAN VERSI MODEL YANG LEBIH STABIL (Gemini 1.5 Flash)
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });

                const data = await response.json();
                
                if (data.error) throw new Error(data.error.message);

                const aiResult = data.candidates[0].content.parts[0].text;
                renderModul(aiResult, v);
                
            } catch (error) {
                console.error(error);
                alert("GAGAL MEMANGGIL AI: " + error.message);
                editor.innerHTML = `<div style="text-align:center; margin-top:50mm; color:red;"><h3>Terjadi Kesalahan</h3><p>${error.message}</p></div>`;
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-magic"></i> GENERATE MODUL LENGKAP';
            }
        }

        function renderModul(content, v) {
            const html = `
                <div class="m-title">MODUL AJAR PEMBELAJARAN MENDALAM + KBC</div>
                <table class="m-table" style="width:100%">
                    <tr><td width="22%"><b>Penyusun</b></td><td width="28%">: ${v('nama')}</td><td width="22%"><b>Fase/Kelas</b></td><td>: ${v('fase_kelas')}</td></tr>
                    <tr><td><b>Mata Pelajaran</b></td><td>: ${v('mapel')}</td><td><b>Madrasah</b></td><td>: ${v('sekolah')}</td></tr>
                    <tr><td><b>Materi Utama</b></td><td>: ${v('materi')}</td><td><b>Tahun Pelajaran</b></td><td>: ${v('tahun')}</td></tr>
                    <tr><td><b>Semester</b></td><td>: ${v('semester')}</td><td><b>Alokasi Waktu</b></td><td>: 8 JP (Disesuaikan)</td></tr>
                </table>
                <div class="m-content" style="white-space: pre-wrap; text-align: justify;">${content}</div>
                <br><br>
                <table style="width:100%; text-align:center;">
                    <tr>
                        <td width="50%">Mengetahui,<br>Kepala Madrasah<br><br><br><br>_________________</td>
                        <td>Brebes, ${new Date().toLocaleDateString('id-ID', {day: 'numeric', month:'long', year:'numeric'})}<br>Guru Mata Pelajaran<br><br><br><br><strong>${v('nama')}</strong></td>
                    </tr>
                </table>
            `;
            document.getElementById('editor').innerHTML = html;
        }

        async function saveWord() {
            const content = document.getElementById('editor').innerHTML;
            const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export Word</title><style>body {font-family: 'Times New Roman'; font-size: 11pt; text-align: justify;}</style></head><body>";
            const footer = "</body></html>";
            const blob = new Blob(['\ufeff', header + content + footer], { type: 'application/msword' });
            saveAs(blob, `Modul_Ajar_${document.getElementById('materi').value.replace(/\s/g, '_')}.doc`);
        }
    </script>
</body>
</html>
