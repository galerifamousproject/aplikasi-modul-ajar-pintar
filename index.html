<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administrasi Guru Pintar - Galeri Famous Project</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        :root { --primary: #4338ca; --secondary: #db2777; --bg: #e2e8f0; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: #1e293b; overflow-x: hidden; }

        header {
            background: linear-gradient(-45deg, #4338ca, #6366f1, #db2777, #ec4899);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            padding: 3rem 2rem 6rem; text-align: center; color: white;
            border-bottom: 4px solid rgba(255, 255, 255, 0.1);
        }
        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        .main-container {
            max-width: 1450px; margin: -4rem auto 4rem; padding: 0 20px;
            display: grid; grid-template-columns: 420px 1fr; gap: 35px; align-items: start;
        }

        @media (max-width: 1250px) {
            .main-container { display: flex; flex-direction: column; align-items: center; }
            .sidebar { width: 100% !important; max-width: 600px; position: static !important; }
        }

        .sidebar { background: white; border-radius: 2rem; padding: 2.5rem; box-shadow: 0 20px 40px rgba(0,0,0,0.1); position: sticky; top: 2rem; }
        .preview-section { display: flex; flex-direction: column; align-items: center; width: 100%; }

        .paper-shadow {
            background: white; width: 210mm; min-height: 297mm; padding: 20mm 25mm;
            box-shadow: 0 0 50px rgba(0,0,0,0.15); font-family: 'Times New Roman', serif;
            color: #000; outline: none; text-align: justify;
        }

        .form-label { display: block; font-size: 0.75rem; font-weight: 800; color: #64748b; margin-bottom: 0.5rem; text-transform: uppercase; }
        .input-control { width: 100%; padding: 0.9rem; border-radius: 1rem; border: 2px solid #f1f5f9; background: #fcfcfc; margin-bottom: 1.2rem; outline: none; font-size: 0.9rem; }
        .btn-gen { width: 100%; padding: 1.2rem; border-radius: 1.5rem; border: none; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; font-weight: 800; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 1rem; transition: 0.3s; }
        .btn-gen:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(67, 56, 202, 0.3); }

        .m-title { text-align: center; font-weight: bold; font-size: 14pt; text-decoration: underline; margin-bottom: 20px; text-transform: uppercase; }
        .m-table { width: 100%; margin-bottom: 15px; font-size: 11pt; border-bottom: 2px solid #000; padding-bottom: 10px; }
        .m-section { font-weight: bold; margin-top: 15px; display: block; font-size: 11pt; }
        .m-content { margin-left: 15px; margin-bottom: 10px; font-size: 11pt; line-height: 1.6; }

        footer { text-align: center; padding: 60px 20px; color: #64748b; font-size: 0.85rem; font-weight: 700; }
        .dev-highlight { color: var(--primary); font-weight: 800; }
    </style>
</head>
<body>

    <header>
        <h1 style="font-size: 2.8rem; font-weight: 800;">Administrasi Guru Pintar</h1>
        <p style="letter-spacing: 2px; font-weight: 300; text-transform: uppercase;">"Membangun Masa Depan Melalui Pembelajaran Mendalam & Karakter Berbasis Cinta"</p>
    </header>

    <div class="main-container">
        <aside class="sidebar">
            <h3 style="margin-bottom: 25px; font-weight: 800; color: var(--primary); border-left: 5px solid var(--secondary); padding-left: 15px;">Data Administrasi</h3>
            
            <label class="form-label">Identitas Penyusun</label>
            <input type="text" id="nama" class="input-control" placeholder="Nama Lengkap & Gelar">
            <input type="text" id="sekolah" class="input-control" placeholder="Nama Madrasah">

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div>
                    <label class="form-label">Tahun Pelajaran</label>
                    <select id="tahun" class="input-control">
                        <option>2024/2025</option><option selected>2025/2026</option>
                        <option>2026/2027</option><option>2027/2028</option>
                        <option>2028/2029</option><option>2029/2030</option><option>2030/2031</option>
                    </select>
                </div>
                <div>
                    <label class="form-label">Semester</label>
                    <select id="semester" class="input-control"><option>1 (Ganjil)</option><option>2 (Genap)</option></select>
                </div>
            </div>

            <label class="form-label">Jenjang Pendidikan</label>
            <select id="jenjang" class="input-control" onchange="updateSelection()">
                <option value="SD_MI">SD / MI</option>
                <option value="SMP_MTS">SMP / MTs</option>
                <option value="SMA_MA">SMA / MA</option>
            </select>

            <label class="form-label">Fase / Kelas</label>
            <select id="fase_kelas" class="input-control"></select>

            <label class="form-label">Mata Pelajaran</label>
            <select id="mapel" class="input-control"></select>

            <label class="form-label">Topik Utama Pembelajaran</label>
            <textarea id="materi" class="input-control" rows="2" placeholder="Contoh: Energi Terbarukan"></textarea>

            <button onclick="generate()" class="btn-gen"><i class="fas fa-magic"></i> GENERATE MODUL LENGKAP</button>
        </aside>

        <section class="preview-section">
            <div id="editor" contenteditable="true" class="paper-shadow">
                <div style="text-align:center; color:#cbd5e1; margin-top:120mm;">
                    <i class="fas fa-file-invoice" style="font-size: 5rem; margin-bottom: 20px;"></i>
                    <p>Hasil pratinjau muncul di sini.</p>
                </div>
            </div>
            <button onclick="saveWord()" class="btn-gen" style="background: #059669; margin-top: 2rem; width: 210mm;"><i class="fas fa-file-word"></i> DOWNLOAD MODUL (.DOCX)</button>
        </section>
    </div>

    <footer>
        <p>Administrasi Guru Pintar &copy; 2026 | Galeri Famous Project</p>
        <p style="font-size: 0.7rem; opacity: 0.8; margin-top: 5px;">Developed by <span class="dev-highlight">Galeri Famous Project</span> â€¢ Brebes, Indonesia</p>
    </footer>

    <script>
        const database = {
            "SD_MI": { 
                fase: ["Fase A - Kelas 1", "Fase A - Kelas 2", "Fase B - Kelas 3", "Fase B - Kelas 4", "Fase C - Kelas 5", "Fase C - Kelas 6"], 
                mapel: ["IPAS", "Bahasa Indonesia", "Matematika", "Pancasila", "PJOK", "Seni Musik", "Seni Rupa", "Seni Tari", "Seni Teater", "Al-Qur'an Hadis", "Akidah Akhlak", "Fikih", "SKI", "Bahasa Arab", "Bahasa Inggris", "Ke-NU-an", "BTQ", "Bahasa Jawa"] 
            },
            "SMP_MTS": { 
                fase: ["Fase D - Kelas 7", "Fase D - Kelas 8", "Fase D - Kelas 9"], 
                mapel: ["IPA", "IPS", "Bahasa Indonesia", "Matematika", "Bahasa Inggris", "Informatika", "Pancasila", "PJOK", "Seni Budaya", "Al-Qur'an Hadis", "Akidah Akhlak", "Fikih", "SKI", "Bahasa Arab", "Ke-NU-an", "BTQ", "Bahasa Jawa"] 
            },
            "SMA_MA": { 
                fase: ["Fase E - Kelas 10", "Fase F - Kelas 11", "Fase F - Kelas 12"], 
                mapel: ["Bahasa Indonesia", "Matematika", "Bahasa Inggris", "Sejarah", "Pancasila", "PJOK", "Biologi", "Fisika", "Kimia", "Ekonomi", "Sosiologi", "Geografi", "Informatika", "Seni Budaya", "Fikih", "Ushul Fikih", "Akidah Akhlak", "Al-Qur'an Hadis", "SKI", "Ilmu Tafsir", "Ilmu Hadis", "Bahasa Arab", "Ke-NU-an", "Bahasa Jawa"] 
            }
        };

        function updateSelection() {
            const jenjang = document.getElementById('jenjang').value;
            document.getElementById('fase_kelas').innerHTML = database[jenjang].fase.map(f => `<option>${f}</option>`).join("");
            document.getElementById('mapel').innerHTML = database[jenjang].mapel.map(m => `<option>${m}</option>`).join("");
        }
        updateSelection();

        function generate() {
            const v = (id) => document.getElementById(id).value;
            const html = `
                <div class="m-title">MODUL AJAR PEMBELAJARAN MENDALAM+KBC (PjBL)</div>
                <table class="m-table">
                    <tr><td width="20%">Penyusun</td><td width="30%">: ${v('nama')}</td><td width="20%">Fase/Kelas</td><td>: ${v('fase_kelas')}</td></tr>
                    <tr><td>Mata Pelajaran</td><td>: ${v('mapel')}</td><td>Madrasah</td><td>: ${v('sekolah')}</td></tr>
                    <tr><td>Materi Utama</td><td>: ${v('materi')}</td><td>Alokasi Waktu</td><td>: 8 JP (4 Pertemuan)</td></tr>
                    <tr><td>Tahun Pelajaran</td><td>: ${v('tahun')}</td><td>Semester</td><td>: ${v('semester')}</td></tr>
                </table>

                <span class="m-section">1. Identifikasi Profil Murid</span>
                <p class="m-content">Murid menunjukkan transisi kognitif dari pemikiran konkret ke abstrak. Sebagian besar memiliki ketertarikan tinggi pada isu terkait <strong>${v('materi')}</strong> namun membutuhkan stimulasi visual dan aktivitas eksploratif berbasis masalah untuk membangun pemahaman mendalam yang melampaui hafalan definisi.</p>

                <span class="m-section">2. Ringkasan Materi Pembelajaran (Bahan Ajar Utama)</span>
                <p class="m-content">Sebagai acuan utama guru, cakupan materi <strong>${v('materi')}</strong> mencakup Landasan Teoretis mengenai hukum dasar dan sejarah perkembangan konsep, Struktur Konseptual yang membedah mekanisme fungsional, serta Relevansi Ekosistem (Hubbul Biah) guna menjaga kelestarian alam. Implementasi juga ditekankan pada Aplikasi Etis (Hubbunnas) untuk kemaslahatan umat.</p>

                <span class="m-section">3. Identifikasi Materi Pelajaran (Perspektif Pedagogis)</span>
                <p class="m-content">Materi disusun dengan struktur bertingkat (scaffolding) menggunakan alat peraga inovatif guna mencapai level metakognisi yang diharapkan dalam standar Pembelajaran Mendalam (Deep Learning).</p>

                <span class="m-section">4. Dimensi Profil Lulusan (DPL) dan Tema KBC</span>
                <p class="m-content"><b>DPL:</b> 1) Penalaran Kritis, 2) Kreativitas, 3) Kolaborasi, 4) Komunikasi.<br><b>Tema KBC:</b> 1) Hubbunnas (Cinta Sesama), 2) Hubbul Biah (Cinta Lingkungan).</p>

                <span class="m-section">5. Capaian Pembelajaran</span>
                <p class="m-content">Peserta didik menyelidiki fenomena <strong>${v('materi')}</strong> dan penerapan teknologi secara berkelanjutan.</p>

                <span class="m-section">6. Lintas Disiplin Ilmu</span>
                <p class="m-content">Mengintegrasikan Matematika, TIK, Qur'an Hadits, dan Aqidah Akhlak (implementasi etika Hubbul Biah).</p>

                <span class="m-section">7. Topik Pembelajaran</span>
                <p class="m-content">Penerapan strategi inovatif materi <strong>${v('materi')}</strong> untuk memecahkan problematika di lingkungan warga setempat.</p>

                <span class="m-section">8. Tujuan Pembelajaran</span>
                <p class="m-content">1) Menganalisis konsep utama secara akurat. 2) Mengidentifikasi tantangan sumber daya lokal. 3) Merancang prototipe solusi inovatif.</p>

                <span class="m-section">9. Praktik Pedagogis</span>
                <p class="m-content">Model: PjBL (Project Based Learning). Metode: Diskusi kelompok, eksplorasi lapangan, dan Gallery Walk.</p>

                <span class="m-section">10. Mitra Pembelajaran</span>
                <p class="m-content">Guru lintas bidang, orang tua, instansi teknis (PLN/Bank Sampah), dan tokoh masyarakat.</p>

                <span class="m-section">11. Lingkungan Pembelajaran</span>
                <p class="m-content">Ruang Fisik: Taman madrasah dan laboratorium desa. Ruang Virtual: PHET Simulation dan Google Classroom.</p>

                <span class="m-section">12. Pemanfaatan Digital</span>
                <p class="m-content">LMS, Google Form, Video presentasi kreatif, dan Quizizz untuk evaluasi formatif.</p>

                <span class="m-section">13. Langkah-langkah Pembelajaran (Alur MERDEKA)</span>
                <p class="m-content"><b>A. AWAL:</b> Orientasi positif dan pertanyaan pemantik. <b>B. INTI:</b> Eksplorasi literasi, kunjungan lapangan, dan pembuatan prototipe. <b>C. MEREFLEKSI:</b> Uji coba alat dan jurnal refleksi.</p>

                <span class="m-section">14. Asesmen Pembelajaran</span>
                <p class="m-content">Diagnostik: Pengetahuan awal. Formatif: Penilaian proses proyek. Sumatif: Evaluasi produk dan tes tulis HOTS.</p>

                <span class="m-section">15. Media/Sumber Pembelajaran</span>
                <p class="m-content">Laptop, PPT inovatif, Buku teks utama Kurikulum Merdeka, dan artikel internet tervalidasi.</p>

                <br><br>
                <table style="width:100%; text-align:center;">
                    <tr><td width="50%">Kepala Madrasah<br><br><br><br>_________________</td>
                    <td>Brebes, ${new Date().toLocaleDateString('id-ID', {day: 'numeric', month:'long', year:'numeric'})}<br>Guru Mata Pelajaran<br><br><br><br><strong>${v('nama')}</strong></td></tr>
                </table>
            `;
            document.getElementById('editor').innerHTML = html;
        }

        async function saveWord() {
            const { Document, Packer, Paragraph, TextRun, AlignmentType } = docx;
            const editorText = document.getElementById('editor').innerText;
            const lines = editorText.split('\n').filter(l => l.trim() !== "");
            const doc = new Document({
                sections: [{
                    children: lines.map(line => new Paragraph({
                        children: [new TextRun({ text: line, size: 24, font: "Times New Roman" })],
                        spacing: { after: 120 }, alignment: AlignmentType.JUSTIFY
                    }))
                }]
            });
            const blob = await Packer.toBlob(doc);
            saveAs(blob, `Modul_Lengkap_Database_Final.docx`);
        }
    </script>
</body>
</html>
